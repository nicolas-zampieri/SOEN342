@startuml DomainModel
left to right direction

enum Day {
  Mon
  Tue
  Wed
  Thu
  Fri
  Sat
  Sun
  Daily
}

class Class {
  <<enumeration>>
  first
  second
}

entity "RouteDB" as RouteDB {
  *route_id : <<PK>>
  *departure_city
  *arrival_city
  *departure_time
  *arrival_time
  *train_type
  *days_of_op
  *price_first_class
  *price_second_class
}

entity "TravellerDB" as ClientDB {
  *traveller_id : <<PK>>
  *first_name
  *last_name
  *gov_id
  *age
}

entity "TripDB" as TripDB {
  *trip_id : <<PK>>
  *travel_date
  *origin
  *destination
  *stops
  *total_duration
  *fare_class
  *path_summary
  *created_at
}

entity "TripTravellerDB" as TravelDB {
  *(trip_id, traveller_id) : <<PK>>
  *trip_id : <<FK>>
  *traveller_id : <<FK>>
  *trip_id
  *traveller_id
  *seat_class
  *ticket_price
}

class TimeOfDay {
  +h : int
  +m : int
}

class Route {
  +route_id : string
  +dep_city : string
  +arr_city : string
  +dep_time : TimeOfDay
  +arr_time : TimeOfDay
  +train_type : string
  +days : Set<Day>
  +price_first : number
  +price_second : number
}

class Itinerary {
  +legs : List<Route>
  +transfers : List<int>
}

class Query {
  +dep_city : string?
  +arr_city : string?
  +train_type : string?
  +days : Set<Day>?
  +dep_from : TimeOfDay?
  +dep_to : TimeOfDay?
  +max_price_first : number?
  +max_price_second : number?
}

class Client {
  +client_id : string
  +last_name : string
  +first_name : string
}

class Traveller {
  +name : string
  +age : int
  +id : string
}

class Trip {
  +trip_id : string
  +client : Client
  +reservations : List<Reservation>
  +booking_date : Date
}

class Reservation {
  +ticket : Ticket
  +traveller : Traveller
  +route : Route
}

class Ticket {
  +ticket_id : int
  +class_type : Class
  +price : number
}

class BookingService {
  +bookTrip(travellers, route) : Trip
}

class TripViewService {
  +getCurrentTrips(lastName, clientId) : List<Trip>
  +getTripHistory(lastName, clientId) : List<Trip>
}

class ItineraryService
class DayUtils
class TimeUtils
class CSVLoader
class HeaderNormalizer
class ResultRenderer
class RailSearchApp

Itinerary "1" o-- "1..*" Route : legs
Route "1" *-- "1" TimeOfDay : dep_time
Route "1" *-- "1" TimeOfDay : arr_time
Route "1" o-- "0..*" Day : days

Trip "1" *-- "1..*" Reservation : reservations
Trip "1" o-- "1" Client : client
Reservation "1" *-- "1" Ticket : ticket
Reservation "1" o-- "1" Traveller : traveller
Reservation "1" o-- "1" Route : route
Ticket "1" o-- "1" Class : class_type

CSVLoader --> HeaderNormalizer
RailSearchApp --> CSVLoader
RailSearchApp --> ResultRenderer
RailSearchApp --> ItineraryService
RailSearchApp --> BookingService
RailSearchApp --> TripViewService
ItineraryService --> Route
ItineraryService --> Itinerary
ItineraryService --> Query
ItineraryService --> Class
BookingService --> Trip
BookingService --> Reservation
BookingService --> Ticket
BookingService --> Client
BookingService --> Traveller
TripViewService --> Trip
TripViewService --> Client
DayUtils --> Day
TimeUtils --> TimeOfDay
@enduml